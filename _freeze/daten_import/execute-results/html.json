{
  "hash": "2626c5d312a69a833e5dffd5538ab0c0",
  "result": {
    "engine": "knitr",
    "markdown": "# Daten importieren {#sec-daten-import}\n\n\n::: {.cell}\n\n:::\n\n\nBisher haben wir Objekte in R selbst erstellt. In diesem Abschnitt lernen wir, wie man Datensätze in R importiert. Dazu erstellen wir zuerst in dem Ordner unseres R-Projects einen Datenordner und folgende Unterordner:\n\n```\nr_intro/\n├── data/\n│   ├── raw/           # Originaldaten\n│       └── students_data/     # Ordner für Github-Datensätze\n│   └── processed/     # Bearbeitete Daten\n```\n\nAnschließend laden wir ein Set an unterschiedlichen Datensatz-Arten aus dem Github-Ordner des Kurses in den `students_data` Ordner, in dem wir entweder alle Dateien in diesem [Github-Ordner](https://github.com/rintro-fuhagen-econpolicy/rintro-fuhagen-econpolicy.github.io/tree/main/data/raw) manuell herunterladen, oder den folgenden Code in R ausführen:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrepo_url <- \"https://github.com/rintro-fuhagen-econpolicy/rintro-fuhagen-econpolicy.github.io/archive/refs/heads/main.zip\"\ndownload.file(repo_url, destfile = \"repo.zip\")\nunzip(\"repo.zip\")\nfile.copy(\"rintro-fuhagen-econpolicy.github.io-main/data/raw\", \n          \"data/raw\", \n          recursive = TRUE)\nunlink(\"repo.zip\")\nunlink(\"rintro-fuhagen-econpolicy.github.io-main\", recursive = TRUE)\nrm(repo_url)\n```\n:::\n\n\n## Datenformate\n\nIn der Praxis begegnen dir verschiedene Datenformate, die mit unterschiedlichen Funktionen in R eingelesen werden. @tbl-data-formats gibt einen Überblick über die gebräuchlichsten Formate.\n\n\n::: {#tbl-data-formats .cell tbl-cap='Datensatzformate in der Praxis (Auswahl)'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Dateiformat </th>\n   <th style=\"text-align:left;\"> Typisch für </th>\n   <th style=\"text-align:left;\"> Package </th>\n   <th style=\"text-align:left;\"> Lesefunktion </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> csv </td>\n   <td style=\"text-align:left;\"> Allgemein </td>\n   <td style=\"text-align:left;\"> readr (tidyverse) </td>\n   <td style=\"text-align:left;\"> read_csv() </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rds </td>\n   <td style=\"text-align:left;\"> R </td>\n   <td style=\"text-align:left;\"> readr (tidyverse) </td>\n   <td style=\"text-align:left;\"> read_rds() </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> txt </td>\n   <td style=\"text-align:left;\"> Allgemein </td>\n   <td style=\"text-align:left;\"> readr (tidyverse) </td>\n   <td style=\"text-align:left;\"> read_delim() </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> xlsx </td>\n   <td style=\"text-align:left;\"> MS Office </td>\n   <td style=\"text-align:left;\"> readxl </td>\n   <td style=\"text-align:left;\"> read_excel() </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> dta </td>\n   <td style=\"text-align:left;\"> Stata </td>\n   <td style=\"text-align:left;\"> haven </td>\n   <td style=\"text-align:left;\"> read_dta() </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Daten einlesen\n\n### CSV-Dateien\n\nDas CSV-Format (Comma-Separated Values) speichert tabellarische Daten als Text, wobei jede Zeile eine Beobachtung und jede Spalte einen Wert enthält, getrennt durch Kommata oder andere Trennzeichen. Beim Import in R müssen wir auf das korrekte Trennzeichen achten, damit die Zahlen korrekt eingelesen werden.\n\nCSV-Dateien können mit der Funktion `read_csv()` aus dem `tidyverse`/`readr` Package eingelesen werden:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudents <- read_csv(\"data/raw/students_data/students.csv\")\nstudents\n#> # A tibble: 10 × 3\n#>   names     age grade\n#>   <chr>   <dbl> <dbl>\n#> 1 Anna       25   2  \n#> 2 Ben        25   2.7\n#> 3 Clara      21   3.7\n#> 4 Dimitri    24   4  \n#> 5 Emilia     21   5  \n#> 6 Fatima     20   2.3\n#> # ℹ 4 more rows\n```\n:::\n\n\nInternational werden die einzelnen Spalten mit einem Komma (,) getrennt. Dies ist auch das Default-Trennzeichen bei `read_csv()`. Da in der deutschen Sprache dieses als Zeichen für Dezimalstellen verwendet wird, wird hier das Semikolon/der Strichpunkt (;) als Trennzeichen verwendet. Verwenden wir das falsche Trennzeichen beim Einlesen von CSV-Dateien mit diesem Trennzeichen, werden die Daten falsch eingelesen:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nread_csv(\"data/raw/students_data/students_de.csv\")\n#> # A tibble: 10 × 1\n#>   `names;age;grade`\n#>   <chr>            \n#> 1 Anna;25;2,0      \n#> 2 Ben;25;2,7       \n#> 3 Clara;21;3,7     \n#> 4 Dimitri;24;4,0   \n#> 5 Emilia;21;5,0    \n#> 6 Fatima;20;2,3    \n#> # ℹ 4 more rows\n```\n:::\n\n\nStattdessen müssen wir bei einer solchen Encodierung `read_csv2()` verwenden:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nread_csv2(\"data/raw/students_data/students_de.csv\")\n#> # A tibble: 10 × 3\n#>   names     age grade\n#>   <chr>   <dbl> <dbl>\n#> 1 Anna       25   2  \n#> 2 Ben        25   2.7\n#> 3 Clara      21   3.7\n#> 4 Dimitri    24   4  \n#> 5 Emilia     21   5  \n#> 6 Fatima     20   2.3\n#> # ℹ 4 more rows\n```\n:::\n\n\n::: {.callout-warning}\n## Häufige Probleme mit CSV-Dateien\n\n- *Trennzeichen*: `read_csv(\"datei.csv\")` bei `,` als Trennzeichen, `read_csv2(\"datei.csv\")` bei `;`\n- *Encoding*: Bei Problemen mit Sonderzeichen muss das Encoding spezifiziert werden, etwa `read_csv(\"datei.csv\", locale = locale(encoding = \"latin1\"))`\n- *Dezimaltrennzeichen*: Ebenfalls über das `locale` Argument,`locale = locale(decimal_mark = \",\")`\n- *Falsche Spaltentypen*: Mit `col_types` spezifizieren\n:::\n\n### RDS-Dateien\n\nRDS ist ein R-spezifisches Format, das ein einzelnes R-Objekt speichert. RDS speichert Objekte in nativer R-Struktur, inklusive Datentypen, Faktoren, Datum/Zeit und sogar komplexer Objekte wie Modelle, wodurch beim Einlesen keine Umwandlungen nötig sind. RDS-Dateien sind oft kleiner und schneller zu lesen als Textdateien, da keine Konvertierung von und zu Text nötig ist.\n\nWir können RDS-Dateien mit `read_rds()` einlesen:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudents <- read_rds(\"data/raw/students_data/students.rds\")\n```\n:::\n\n\n::: callout-note\n## RData-Format\n\nEin weiteres R-spezifisches Format ist RData. RData kann mehrere Objekte speichern:\n\n::: {.cell}\n\n```{.r .cell-code}\nnumbers <- 6:10\nnames <- c(\"Anna\", \"Ben\", \"Clara\")\nsave(numbers, names, file = \"data/raw/students_data/multidata.RData\")\nrm(numbers, names)\n```\n:::\n\n\nMit `load()` werden alle in dieser Datei abgespeicherten R-Objekte importiert:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(\"data/raw/students_data/multidata.RData\")\n```\n:::\n\n:::\n\n\n### Text-Dateien\n\n### Excel-Dateien\n\n### Stata-Dateien\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}